var x=(v,d,f)=>new Promise((p,r)=>{var l=n=>{try{g(f.next(n))}catch(i){r(i)}},C=n=>{try{g(f.throw(n))}catch(i){r(i)}},g=n=>n.done?p(n.value):Promise.resolve(n.value).then(l,C);g((f=f.apply(v,d)).next())});import{i as b,r as P,c as z,a8 as A,N as H,a as K,a2 as U,z as Y,l as m,q as e,a9 as G,e as M,j as u,k as a,x as o,v as y,t as _,f as h,a3 as I,F as J,H as Q,n as W}from"./frappe-ui-Cee7Yz-T.js";import{b as X,I as Z,a as ee,c as te}from"./index-67wm3rxu.js";import{f as oe}from"./formatters-Ephtd2vf.js";import se from"./ProfileInfoModal-D9R6WlFC.js";import{a as ae}from"./notifications-DcGs5nX-.js";import"./FormattedField-CUhRRhqS.js";import"./EmployeeAvatar-DoNux1Vg.js";const ne=v=>x(void 0,null,function*(){yield(yield X.create({header:"Error",message:v,buttons:["OK"]})).present()}),le={class:"flex flex-col h-screen w-screen"},re={class:"w-full sm:w-96"},ce={class:"flex flex-row bg-white shadow-sm py-4 px-3 items-center justify-between border-b sticky top-0 z-10"},ie={class:"flex flex-row items-center"},de={class:"text-xl font-semibold text-gray-900"},me={class:"flex flex-col items-center mt-5 p-4"},ue=["src","alt"],_e={key:1,class:"flex items-center justify-center bg-gray-200 uppercase text-gray-600 h-24 w-24 rounded-full object-cover"},fe={class:"flex flex-col gap-1.5 items-center mt-2 mb-5"},pe={key:0,class:"text-lg font-bold text-gray-900"},ye={key:1,class:"font-normal text-sm text-gray-500"},he={class:"flex flex-col gap-5 my-4 w-full"},ge={class:"flex flex-col bg-white rounded"},xe=["onClick"],be={class:"flex flex-row items-center gap-3 grow"},we={class:"text-base font-normal text-gray-800"},ve={key:2,class:"flex flex-col gap-5 my-4 w-full"},ke={class:"flex flex-col bg-white rounded"},Ce={class:"flex flex-row items-center gap-3 grow"},Ie={class:"text-base font-normal text-gray-800"},w="Employee",Oe={__name:"Profile",setup(v){const d=b("$socket"),f=b("$session"),p=b("$user"),r=b("$employee"),l=b("$translate"),C=G(),g=[{icon:"user",title:l("Employee Details"),fields:["employee_name","employee_number","gender","date_of_birth","date_of_joining","blood_group"]},{icon:"file",title:l("Company Information"),fields:["company","department","designation","branch","grade","reports_to","employment_type"]},{icon:"book",title:l("Contact Information"),fields:["cell_number","personal_email","company_email","preferred_email"]},{icon:"dollar-sign",title:l("Salary Information"),fields:["ctc","payroll_cost_center","pan_number","provident_fund_account","salary_mode","bank_name","bank_ac_no","ifsc_code","micr_code","iban"]}],n=P(!1),i=P(null),O=z(()=>{var t;return((t=window.frappe)==null?void 0:t.boot.push_relay_server_url)&&ae.data}),S=t=>x(this,null,function*(){i.value=t,n.value=!0}),V=t=>x(this,null,function*(){n.value=!1,i.value=null}),j=A({doctype:w,name:r.data.name,auto:!0,transform:t=>(t.ctc=oe(t.ctc,t.salary_currency),t)}),F=H({url:"hrms.api.get_doctype_fields",params:{doctype:w},auto:!0}),L=t=>{const s=F.data.find(k=>k.fieldname===t);return[l(s==null?void 0:s.label,null,"Employee"),s==null?void 0:s.fieldtype]},R=()=>x(this,null,function*(){try{yield f.logout.submit()}catch(t){const s="An error occurred while attempting to log out!";console.error(s,t),ne(s)}});return K(()=>{d.emit("doctype_subscribe",w),d.on("list_update",t=>{t.doctype===w&&t.name===r.data.name&&j.reload()})}),U(()=>{d.emit("doctype_unsubscribe",w),d.off("list_update")}),(t,s)=>{const k=M("Button"),T=M("router-link");return u(),Y(e(Z),null,{default:m(()=>[a(e(ee),{class:"ion-padding"},{default:m(()=>{var $,D,E,B;return[o("div",le,[o("div",re,[o("header",ce,[o("div",ie,[a(k,{variant:"ghost",class:"!pl-0 hover:bg-white",onClick:s[0]||(s[0]=c=>e(C).back())},{default:m(()=>[a(e(y),{name:"chevron-left",class:"h-5 w-5"})]),_:1}),o("h2",de,_(e(l)("Profile")),1)])]),o("div",me,[e(p).data.user_image?(u(),h("img",{key:0,class:"h-24 w-24 rounded-full object-cover",src:e(p).data.user_image,alt:e(p).data.first_name},null,8,ue)):(u(),h("div",_e,_(e(p).data.first_name[0]),1)),o("div",fe,[e(r)?(u(),h("span",pe,_((D=($=e(r))==null?void 0:$.data)==null?void 0:D.employee_name),1)):I("",!0),e(r)?(u(),h("span",ye,_((B=(E=e(r))==null?void 0:E.data)==null?void 0:B.designation),1)):I("",!0)]),o("div",he,[o("div",ge,[(u(),h(J,null,Q(g,c=>o("div",{class:"flex flex-row cursor-pointer flex-start p-4 items-center justify-between border-b",key:c.title,onClick:N=>S(c)},[o("div",be,[a(e(y),{name:c.icon,class:"h-5 w-5 text-gray-500"},null,8,["name"]),o("div",we,_(c.title),1)]),a(e(y),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})],8,xe)),64))])]),O.value?(u(),h("div",ve,[o("div",ke,[a(T,{to:{name:"Settings"},class:"flex flex-row cursor-pointer flex-start p-4 items-center justify-between border-b"},{default:m(()=>[o("div",Ce,[a(e(y),{name:"settings",class:"h-5 w-5 text-gray-500"}),o("div",Ie,_(e(l)("Settings")),1)]),a(e(y),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})]),_:1})])])):I("",!0),a(k,{onClick:R,variant:"outline",theme:"red",class:"w-full shadow py-4 mt-5"},{prefix:m(()=>[a(e(y),{name:"log-out",class:"w-4"})]),default:m(()=>[W(" "+_(e(l)("Log Out")),1)]),_:1})])])]),a(e(te),{ref:"modal","is-open":n.value,onDidDismiss:V,"initial-breakpoint":1,breakpoints:[0,1]},{default:m(()=>[a(se,{title:i.value.title,data:i.value.fields.map(c=>{const[N,q]=L(c);return{fieldname:c,value:e(j).doc[c],label:N,fieldtype:q}})},null,8,["title","data"])]),_:1},8,["is-open"])]}),_:1})]),_:1})}}};export{Oe as default};
//# sourceMappingURL=Profile-C00tjRhG.js.map
