{"version":3,"file":"attendance-BRvU06nR.js","sources":["../../../../frontend/src/data/attendance.js"],"sourcesContent":["import { createResource } from \"frappe-ui\"\nimport { employeeResource } from \"./employee\"\n\nimport dayjs from \"@/utils/dayjs\"\n\n\nexport const getDates = (shift) => {\n\tconst fromDate = dayjs(shift.from_date).format(\"D MMM\")\n\tconst toDate = shift.to_date ? dayjs(shift.to_date).format(\"D MMM\") : \"Ongoing\"\n\treturn fromDate == toDate ? fromDate : `${fromDate} - ${toDate}`\n}\n\nexport const getTotalDays = (shift) => {\n\tif (!shift.to_date) return null\n\tconst toDate = dayjs(shift.to_date)\n\tconst fromDate = dayjs(shift.from_date)\n\treturn toDate.diff(fromDate, \"d\") + 1\n}\n\nexport const getShiftDates = (shift) => {\n\tconst startDate = dayjs(shift.start_date).format(\"D MMM\")\n\tconst endDate = shift.end_date ? dayjs(shift.end_date).format(\"D MMM\") : \"Ongoing\"\n\treturn startDate == endDate ? startDate : `${startDate} - ${endDate}`\n}\n\nexport const getTotalShiftDays = (shift) => {\n\tif (!shift.end_date) return null\n\tconst end_date = dayjs(shift.end_date)\n\tconst start_date = dayjs(shift.start_date)\n\treturn end_date.diff(start_date, \"d\") + 1\n}\n\nexport const getShiftTiming = (shift) => {\n\treturn (\n\t\tshift.start_time.split(\":\").slice(0, 2).join(\":\") +\n\t\t\" - \" +\n\t\tshift.end_time.split(\":\").splice(0, 2).join(\":\")\n\t)\n}\n\nconst transformShiftRequests = (data) =>\n\tdata.map((request) => {\n\t\trequest.doctype = \"Shift Request\"\n\t\trequest.shift_dates = getDates(request)\n\t\trequest.total_shift_days = getTotalDays(request)\n\t\treturn request\n\t})\n\nexport const myAttendanceRequests = createResource({\n\turl: \"hrms.api.get_attendance_requests\",\n\tparams: {\n\t\temployee: employeeResource.data.name,\n\t\tlimit: 10,\n\t},\n\tauto: true,\n\tcache: \"hrms:my_attendance_requests\",\n\ttransform(data) {\n\t\treturn transformAttendanceRequests(data)\n\t}\n})\nconst transformAttendanceRequests = (data) => {\n\t\treturn data.map((request) => {\n\t\t\trequest.doctype = \"Attendance Request\"\n\t\t\trequest.attendance_dates = getDates(request)\n\t\t\trequest.total_attendance_days = getTotalDays(request)\n\t\t\treturn request\n\t\t})\n}\nexport const myShiftRequests = createResource({\n\turl: \"hrms.api.get_shift_requests\",\n\tparams: {\n\t\temployee: employeeResource.data.name,\n\t\tlimit: 10,\n\t},\n\tauto: true,\n\tcache: \"hrms:my_shift_requests\",\n\ttransform(data) {\n\t\treturn transformShiftRequests(data)\n\t},\n})\n\nexport const teamShiftRequests = createResource({\n\turl: \"hrms.api.get_shift_requests\",\n\tparams: {\n\t\temployee: employeeResource.data.name,\n\t\tapprover_id: employeeResource.data.user_id,\n\t\tfor_approval: 1,\n\t\tlimit: 10,\n\t},\n\tauto: true,\n\tcache: \"hrms:team_shift_requests\",\n\ttransform(data) {\n\t\treturn transformShiftRequests(data)\n\t},\n})\nexport const teamAttendanceRequests = createResource({\n\turl: \"hrms.api.get_attendance_requests\",\n\tparams: {\n\t\temployee: employeeResource.data.name,\n\t\tfor_approval: 1,\n\t\tlimit: 10,\n\t},\n\tauto: true,\n\tcache: \"hrms:team_attendance_requests\",\n\ttransform: (data) => {\n\t\treturn transformAttendanceRequests(data)\n\t},\n})\n"],"names":["getDates","shift","fromDate","dayjs","toDate","getTotalDays","getShiftDates","startDate","endDate","getTotalShiftDays","end_date","start_date","getShiftTiming","transformShiftRequests","data","request","myAttendanceRequests","createResource","employeeResource","transformAttendanceRequests","myShiftRequests","teamShiftRequests","teamAttendanceRequests"],"mappings":"2FAMY,MAACA,EAAYC,GAAU,CAClC,MAAMC,EAAWC,EAAMF,EAAM,SAAS,EAAE,OAAO,OAAO,EAChDG,EAASH,EAAM,QAAUE,EAAMF,EAAM,OAAO,EAAE,OAAO,OAAO,EAAI,UACtE,OAAOC,GAAYE,EAASF,EAAW,GAAGA,CAAQ,MAAME,CAAM,EAC/D,EAEaC,EAAgBJ,GAAU,CACtC,GAAI,CAACA,EAAM,QAAS,OAAO,KAC3B,MAAMG,EAASD,EAAMF,EAAM,OAAO,EAC5BC,EAAWC,EAAMF,EAAM,SAAS,EACtC,OAAOG,EAAO,KAAKF,EAAU,GAAG,EAAI,CACrC,EAEaI,EAAiBL,GAAU,CACvC,MAAMM,EAAYJ,EAAMF,EAAM,UAAU,EAAE,OAAO,OAAO,EAClDO,EAAUP,EAAM,SAAWE,EAAMF,EAAM,QAAQ,EAAE,OAAO,OAAO,EAAI,UACzE,OAAOM,GAAaC,EAAUD,EAAY,GAAGA,CAAS,MAAMC,CAAO,EACpE,EAEaC,EAAqBR,GAAU,CAC3C,GAAI,CAACA,EAAM,SAAU,OAAO,KAC5B,MAAMS,EAAWP,EAAMF,EAAM,QAAQ,EAC/BU,EAAaR,EAAMF,EAAM,UAAU,EACzC,OAAOS,EAAS,KAAKC,EAAY,GAAG,EAAI,CACzC,EAEaC,EAAkBX,GAE7BA,EAAM,WAAW,MAAM,GAAG,EAAE,MAAM,EAAG,CAAC,EAAE,KAAK,GAAG,EAChD,MACAA,EAAM,SAAS,MAAM,GAAG,EAAE,OAAO,EAAG,CAAC,EAAE,KAAK,GAAG,EAI3CY,EAA0BC,GAC/BA,EAAK,IAAKC,IACTA,EAAQ,QAAU,gBAClBA,EAAQ,YAAcf,EAASe,CAAO,EACtCA,EAAQ,iBAAmBV,EAAaU,CAAO,EACxCA,EACP,EAEWC,EAAuBC,EAAe,CAClD,IAAK,mCACL,OAAQ,CACP,SAAUC,EAAiB,KAAK,KAChC,MAAO,EACP,EACD,KAAM,GACN,MAAO,8BACP,UAAUJ,EAAM,CACf,OAAOK,EAA4BL,CAAI,CACzC,CACA,CAAC,EACKK,EAA+BL,GAC5BA,EAAK,IAAKC,IAChBA,EAAQ,QAAU,qBAClBA,EAAQ,iBAAmBf,EAASe,CAAO,EAC3CA,EAAQ,sBAAwBV,EAAaU,CAAO,EAC7CA,EACP,EAEUK,EAAkBH,EAAe,CAC7C,IAAK,8BACL,OAAQ,CACP,SAAUC,EAAiB,KAAK,KAChC,MAAO,EACP,EACD,KAAM,GACN,MAAO,yBACP,UAAUJ,EAAM,CACf,OAAOD,EAAuBC,CAAI,CAClC,CACF,CAAC,EAEYO,EAAoBJ,EAAe,CAC/C,IAAK,8BACL,OAAQ,CACP,SAAUC,EAAiB,KAAK,KAChC,YAAaA,EAAiB,KAAK,QACnC,aAAc,EACd,MAAO,EACP,EACD,KAAM,GACN,MAAO,2BACP,UAAUJ,EAAM,CACf,OAAOD,EAAuBC,CAAI,CAClC,CACF,CAAC,EACYQ,EAAyBL,EAAe,CACpD,IAAK,mCACL,OAAQ,CACP,SAAUC,EAAiB,KAAK,KAChC,aAAc,EACd,MAAO,EACP,EACD,KAAM,GACN,MAAO,gCACP,UAAYJ,GACJK,EAA4BL,CAAI,CAEzC,CAAC"}