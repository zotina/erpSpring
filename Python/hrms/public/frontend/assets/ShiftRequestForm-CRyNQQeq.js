import{I as q,a as g}from"./index-67wm3rxu.js";import{r as F,N as u,i as R,w as d,z as f,l as p,q as i,j as c,k as S,a3 as V}from"./frappe-ui-Cee7Yz-T.js";import b from"./FormView-B2Uh12No.js";import"./FormField-CAm_QixC.js";import"./Link-PW9qmcCL.js";import"./FileUploaderView-B-HamLML.js";import"./workflow-BVhqibwi.js";import"./formatters-Ephtd2vf.js";const j={__name:"ShiftRequestForm",props:{id:{type:String,required:!1}},setup(_){const s=R("$employee"),l=_,r=F({}),n=u({url:"hrms.api.get_doctype_fields",params:{doctype:"Shift Request"},auto:!0,transform(e){return l.id?e:e.filter(a=>!["employee","employee_name","status","company"].includes(a.fieldname))}});u({url:"hrms.api.get_shift_request_approvers",params:{employee:s.data.name},auto:!l.id,onSuccess(e){var o,m;const a=(o=n.data)==null?void 0:o.find(t=>t.fieldname==="approver");a.documentList=e==null?void 0:e.map(t=>({label:t.full_name?`${t.name} : ${t.full_name}`:t.name,value:t.name})),r.value.approver=(m=e[0])==null?void 0:m.name}}),d(()=>r.value.employee,e=>{l.id&&e!==s.data.name&&y()}),d(()=>[r.value.from_date,r.value.to_date],([e,a])=>{v(e,a)});function y(){r.value.approver!==s.data.user_id&&n.data.map(e=>e.read_only=!0)}function v(e,a){if(!(e&&a))return;const o=e>a?__("To Date cannot be before From Date"):"",m=n.data.find(t=>t.fieldname==="from_date");m.error_message=o}function h(){r.value.employee=s.data.name}return(e,a)=>(c(),f(i(q),null,{default:p(()=>[S(i(g),{fullscreen:!0},{default:p(()=>[i(n).data?(c(),f(b,{key:0,doctype:"Shift Request",modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=o=>r.value=o),isSubmittable:!0,fields:i(n).data,id:l.id,onValidateForm:h},null,8,["modelValue","fields","id"])):V("",!0)]),_:1})]),_:1}))}};export{j as default};
//# sourceMappingURL=ShiftRequestForm-CRyNQQeq.js.map
