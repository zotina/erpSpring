{"version":3,"file":"Login-DWOHBVSF.js","sources":["../../../../frontend/src/components/icons/FrappeHRLogo.vue","../../../../frontend/src/views/Login.vue"],"sourcesContent":["<template>\n\t<svg\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\twidth=\"117\"\n\t\theight=\"117\"\n\t\tviewBox=\"0 0 117 117\"\n\t\tfill=\"none\"\n\t>\n\t\t<g clip-path=\"url(#clip0_0_45)\">\n\t\t\t<path\n\t\t\t\td=\"M93.4394 0H23.5606C10.5485 0 0 10.5485 0 23.5606V93.4394C0 106.452 10.5485 117 23.5606 117H93.4394C106.452 117 117 106.452 117 93.4394V23.5606C117 10.5485 106.452 0 93.4394 0Z\"\n\t\t\t\tfill=\"#A1EEC9\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M56.3316 68.0044C45.408 68.0044 36.4657 59.1156 36.4657 48.1385V46.425L47.068 46.5321L46.9609 48.1385C46.9609 53.279 51.1376 57.5092 56.3316 57.5092H60.6154C65.7559 57.5092 69.9861 53.3325 69.9861 48.1385V43.8547C69.9861 38.7142 65.8094 34.484 60.6154 34.484H36.3586L36.4657 23.8817L60.6154 23.9888C71.5389 23.9888 80.4813 32.8776 80.4813 43.8547V48.1385C80.4813 59.062 71.5925 68.0044 60.6154 68.0044H56.3316Z\"\n\t\t\t\tfill=\"#0B313A\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M32.1281 85.0856C39.4105 78.7135 48.7812 75.1258 58.5267 75.1258C68.2723 75.1258 77.643 78.7135 84.9254 85.2462L77.8572 93.0105C72.5025 88.2448 65.6485 85.621 58.5267 85.621C51.405 85.621 44.4974 88.2448 39.1428 93.064L32.1817 85.0856H32.1281Z\"\n\t\t\t\tfill=\"#0B313A\"\n\t\t\t/>\n\t\t</g>\n\t\t<defs>\n\t\t\t<clipPath id=\"clip0_0_45\">\n\t\t\t\t<rect width=\"117\" height=\"117\" fill=\"white\" />\n\t\t\t</clipPath>\n\t\t</defs>\n\t</svg>\n</template>\n","<template>\n\t<ion-page>\n\t\t<ion-content class=\"ion-padding\">\n\t\t\t<div class=\"flex h-screen w-screen flex-col justify-center bg-white\">\n\t\t\t\t<div class=\"flex flex-col mx-auto gap-3 items-center\">\n\t\t\t\t\t<FrappeHRLogo class=\"h-8 w-8\" />\n\t\t\t\t\t<div class=\"text-3xl font-semibold text-gray-900 text-center\">\n\t\t\t\t\t\t{{ __(\"Login to Frappe HR\") }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"mx-auto mt-10 w-full px-8 sm:w-96\">\n\t\t\t\t\t<form class=\"flex flex-col space-y-4\" @submit.prevent=\"submit\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t:label=\"__('Email')\"\n\t\t\t\t\t\t\t:placeholder=\"__('johndoe@mail.com')\"\n\t\t\t\t\t\t\tv-model=\"email\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tautocomplete=\"username\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t:label=\"__('Password')\"\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tplaceholder=\"••••••\"\n\t\t\t\t\t\t\tv-model=\"password\"\n\t\t\t\t\t\t\tautocomplete=\"current-password\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ErrorMessage :message=\"errorMessage\" />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:loading=\"session.login.loading\"\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\tclass=\"disabled:bg-gray-700 disabled:text-white !mt-6\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ __(\"Login\") }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</form>\n\n\t\t\t\t\t<template v-if=\"authProviders.data?.length\">\n\t\t\t\t\t\t<div class=\"text-center text-sm text-gray-600 my-4\">or</div>\n\t\t\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tv-for=\"provider in authProviders.data\"\n\t\t\t\t\t\t\t\t:key=\"provider.name\"\n\t\t\t\t\t\t\t\tclass=\"flex items-center justify-center gap-2 transition-colors focus:outline-none text-gray-800 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base p-2 rounded\"\n\t\t\t\t\t\t\t\t:href=\"provider.auth_url\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<img class=\"h-4 w-4\" :src=\"provider.icon\" :alt=\"provider.provider_name\" />\n\t\t\t\t\t\t\t\t<span>Login with {{ provider.provider_name }}</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<Dialog v-model=\"resetPassword.showDialog\">\n\t\t\t\t<template #body-title>\n\t\t\t\t\t<h2 class=\"text-lg font-bold\">{{ __(\"Reset Password\") }} </h2>\n\t\t\t\t</template>\n\t\t\t\t<template #body-content>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{{ __(\"Your password has expired. Please reset your password to continue\") }}\n\t\t\t\t\t</p>\n\t\t\t\t</template>\n\t\t\t\t<template #actions>\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"inline-flex items-center justify-center gap-2 transition-colors focus:outline-none text-white bg-gray-900 hover:bg-gray-800 active:bg-gray-700 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base px-2 rounded\"\n\t\t\t\t\t\t:href=\"resetPassword.link\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ __(\"Go to Reset Password page\") }}\n\t\t\t\t\t</a>\n\t\t\t\t</template>\n\t\t\t</Dialog>\n\n\t\t\t<Dialog v-model=\"otp.showDialog\">\n\t\t\t\t<template #body-title>\n\t\t\t\t\t<h2 class=\"text-lg font-bold\">{{ __(\"OTP Verification\") }}</h2>\n\t\t\t\t</template>\n\t\t\t\t<template #body-content>\n\t\t\t\t\t<p class=\"mb-4\" v-if=\"otp.verification.prompt\">\n\t\t\t\t\t\t{{ otp.verification.prompt }}\n\t\t\t\t\t</p>\n\n\t\t\t\t\t<form class=\"flex flex-col space-y-4\" @submit.prevent=\"submit\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t:label=\"__('OTP Code')\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder=\"000000\"\n\t\t\t\t\t\t\tv-model=\"otp.code\"\n\t\t\t\t\t\t\tautocomplete=\"one-time-code\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ErrorMessage :message=\"errorMessage\" />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:loading=\"session.otp.loading\"\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\tclass=\"disabled:bg-gray-700 disabled:text-white !mt-6\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ __(\"Verify\") }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</form>\n\t\t\t\t</template>\n\t\t\t</Dialog>\n\t\t</ion-content>\n\t</ion-page>\n</template>\n\n<script setup>\nimport { IonPage, IonContent } from \"@ionic/vue\"\nimport { inject, reactive, ref } from \"vue\"\nimport { Input, Button, ErrorMessage, Dialog, createResource } from \"frappe-ui\"\n\nimport FrappeHRLogo from \"@/components/icons/FrappeHRLogo.vue\"\n\nconst email = ref(null)\nconst password = ref(null)\nconst errorMessage = ref(\"\")\n\nconst resetPassword = reactive({\n\tshowDialog: false,\n\tlink: \"\",\n})\nconst otp = reactive({\n\tshowDialog: false,\n\ttmp_id: \"\",\n\tcode: \"\",\n\tverification: {},\n})\n\nconst session = inject(\"$session\")\nconst __ = inject(\"$translate\")\n\nasync function submit(e) {\n\ttry {\n\t\tlet response\n\t\tif (otp.showDialog) {\n\t\t\tresponse = await session.otp(otp.tmp_id, otp.code)\n\t\t} else {\n\t\t\tresponse = await session.login(email.value, password.value)\n\t\t}\n\n\t\tif (response.message === \"Password Reset\") {\n\t\t\tresetPassword.showDialog = true\n\t\t\tresetPassword.link = response.redirect_to\n\t\t} else {\n\t\t\tresetPassword.showDialog = false\n\t\t\tresetPassword.link = \"\"\n\t\t}\n\n\t\t// OTP verification\n\t\tif (response.verification) {\n\t\t\tif (response.verification.setup) {\n\t\t\t\totp.showDialog = true\n\t\t\t\totp.tmp_id = response.tmp_id\n\t\t\t\totp.verification = response.verification\n\t\t\t} else {\n\t\t\t\t// Don't bother handling impossible OTP setup (e.g. no phone number).\n\t\t\t\twindow.open(\"/login?redirect-to=\" + encodeURIComponent(window.location.pathname), \"_blank\")\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\terrorMessage.value = error.messages.join(\"\\n\")\n\t}\n}\n\nconst authProviders = createResource({\n\turl: \"hrms.api.oauth.oauth_providers\",\n\tauto: true,\n})\n</script>\n"],"names":["_hoisted_1","_sfc_render","_ctx","_cache","email","ref","password","errorMessage","resetPassword","reactive","otp","session","inject","__","submit","e","__async","response","error","authProviders","createResource"],"mappings":"icAEEA,EAAkC,CAClC,MAAM,6BACN,YACA,aACA,QAAW,2BALZ,SAAAC,EAAAC,EAAAC,EAAA,kgDCgHD,MAAMC,EAAQC,EAAI,IAAI,EAChBC,EAAWD,EAAI,IAAI,EACnBE,EAAeF,EAAI,EAAE,EAErBG,EAAgBC,EAAS,CAC9B,WAAY,GACZ,KAAM,EACP,CAAC,EACKC,EAAMD,EAAS,CACpB,WAAY,GACZ,OAAQ,GACR,KAAM,GACN,aAAc,CAAE,CACjB,CAAC,EAEKE,EAAUC,EAAO,UAAU,EAC3BC,EAAKD,EAAO,YAAY,EAE9B,SAAeE,EAAOC,EAAG,QAAAC,EAAA,sBACxB,GAAI,CACH,IAAIC,EACAP,EAAI,WACPO,EAAW,MAAMN,EAAQ,IAAID,EAAI,OAAQA,EAAI,IAAI,EAEjDO,EAAW,MAAMN,EAAQ,MAAMP,EAAM,MAAOE,EAAS,KAAK,EAGvDW,EAAS,UAAY,kBACxBT,EAAc,WAAa,GAC3BA,EAAc,KAAOS,EAAS,cAE9BT,EAAc,WAAa,GAC3BA,EAAc,KAAO,IAIlBS,EAAS,eACRA,EAAS,aAAa,OACzBP,EAAI,WAAa,GACjBA,EAAI,OAASO,EAAS,OACtBP,EAAI,aAAeO,EAAS,cAG5B,OAAO,KAAK,sBAAwB,mBAAmB,OAAO,SAAS,QAAQ,EAAG,QAAQ,EAG5F,OAAQC,EAAO,CACfX,EAAa,MAAQW,EAAM,SAAS,KAAK;AAAA,CAAI,CAC/C,CACA,GAEA,MAAMC,EAAgBC,EAAe,CACpC,IAAK,iCACL,KAAM,EACP,CAAC"}