{"version":3,"file":"AttendanceCalendar-BOLvXvt4.js","sources":["../../../../frontend/src/components/AttendanceCalendar.vue"],"sourcesContent":["<template>\n\t<div class=\"flex flex-col w-full gap-5\" v-if=\"calendarEvents.data\">\n\t\t<div class=\"text-lg text-gray-800 font-bold\">{{ __(\"Attendance Calendar\") }}</div>\n\n\t\t<div class=\"flex flex-col gap-6 bg-white py-6 px-3.5 rounded-lg border-none\">\n\t\t\t<!-- Month Change -->\n\t\t\t<div class=\"flex flex-row justify-between items-center px-4\">\n\t\t\t\t<Button\n\t\t\t\t\ticon=\"chevron-left\"\n\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t@click=\"firstOfMonth = firstOfMonth.subtract(1, 'M')\"\n\t\t\t\t/>\n\t\t\t\t<span class=\"text-lg text-gray-800 font-bold\">\n\t\t\t\t\t{{ firstOfMonth.format(\"MMMM\") }} {{ firstOfMonth.format(\"YYYY\") }}\n\t\t\t\t</span>\n\t\t\t\t<Button\n\t\t\t\t\ticon=\"chevron-right\"\n\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t@click=\"firstOfMonth = firstOfMonth.add(1, 'M')\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<!-- Calendar -->\n\t\t\t<div class=\"grid grid-cols-7 gap-y-3\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"day in DAYS\"\n\t\t\t\t\tclass=\"flex justify-center text-gray-600 text-sm font-medium leading-6\"\n\t\t\t\t>\n\t\t\t\t\t{{ day }}\n\t\t\t\t</div>\n\t\t\t\t<div v-for=\"_ in firstOfMonth.get('d')\" />\n\t\t\t\t<div v-for=\"index in firstOfMonth.endOf('M').get('D')\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"h-8 w-8 flex rounded-full mx-auto\"\n\t\t\t\t\t\t:class=\"getEventOnDate(index) && colorMap[getEventOnDate(index)]\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"text-gray-800 text-sm font-medium m-auto\">\n\t\t\t\t\t\t\t{{ index }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<hr />\n\n\t\t\t<!-- Summary -->\n\t\t\t<div class=\"grid grid-cols-4 mx-2\">\n\t\t\t\t<div v-for=\"status in summaryStatuses\" class=\"flex flex-col gap-1\">\n\t\t\t\t\t<div class=\"flex flex-row gap-1 items-center\">\n\t\t\t\t\t\t<span class=\"rounded full h-3 w-3\" :class=\"colorMap[status]\" />\n\t\t\t\t\t\t<span class=\"text-gray-600 text-sm font-medium leading-5\"> {{ __(status) }} </span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class=\"text-gray-800 text-base font-semibold leading-6 mx-auto\">\n\t\t\t\t\t\t{{ summary[status] || 0 }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup>\nimport { computed, inject, ref, watch } from \"vue\"\nimport { createResource } from \"frappe-ui\"\n\nconst dayjs = inject(\"$dayjs\")\nconst employee = inject(\"$employee\")\nconst __ = inject(\"$translate\")\nconst firstOfMonth = ref(dayjs().date(1).startOf(\"D\"))\n\nconst colorMap = {\n\tPresent: \"bg-green-300\",\n\t\"Work From Home\": \"bg-green-300\",\n\t\"Half Day\": \"bg-yellow-200\",\n\tAbsent: \"bg-red-200\",\n\t\"On Leave\": \"bg-blue-300\",\n\tHoliday: \"bg-gray-300\",\n}\n\n// __(\"Present\"), __(\"Half Day\"), __(\"Absent\"), __(\"On Leave\"), __(\"Work From Home\")\nconst summaryStatuses = [\"Present\", \"Half Day\", \"Absent\", \"On Leave\"]\n\nconst summary = computed(() => {\n\tconst summary = {}\n\n\tfor (const status of Object.values(calendarEvents.data)) {\n\t\tlet updatedStatus = status === \"Work From Home\" ? \"Present\" : status\n\t\tif (updatedStatus in summary) {\n\t\t\tsummary[updatedStatus] += 1\n\t\t} else {\n\t\t\tsummary[updatedStatus] = 1\n\t\t}\n\t}\n\n\treturn summary\n})\n\nwatch(\n\t() => firstOfMonth.value,\n\t() => {\n\t\tcalendarEvents.fetch()\n\t}\n)\n\nconst getEventOnDate = (date) => {\n\treturn calendarEvents.data[firstOfMonth.value.date(date).format(\"YYYY-MM-DD\")]\n}\n\nconst getFirstLetter = (s) => Array.from(s.trim())[0] // Unicode\n\nconst DAYS = [\n\tgetFirstLetter(__(\"Sunday\")),\n\tgetFirstLetter(__(\"Monday\")),\n\tgetFirstLetter(__(\"Tuesday\")),\n\tgetFirstLetter(__(\"Wednesday\")),\n\tgetFirstLetter(__(\"Thursday\")),\n\tgetFirstLetter(__(\"Friday\")),\n\tgetFirstLetter(__(\"Saturday\")),\n]\n\n//resources\nconst calendarEvents = createResource({\n\turl: \"hrms.api.get_attendance_calendar_events\",\n\tauto: true,\n\tcache: \"hrms:attendance_calendar_events\",\n\tmakeParams() {\n\t\treturn {\n\t\t\temployee: employee.data.name,\n\t\t\tfrom_date: firstOfMonth.value.format(\"YYYY-MM-DD\"),\n\t\t\tto_date: firstOfMonth.value.endOf(\"M\").format(\"YYYY-MM-DD\"),\n\t\t}\n\t},\n})\n</script>\n"],"names":["dayjs","inject","employee","__","firstOfMonth","ref","colorMap","summaryStatuses","summary","computed","status","calendarEvents","updatedStatus","watch","getEventOnDate","date","getFirstLetter","s","DAYS","createResource"],"mappings":"k2BAiEA,MAAMA,EAAQC,EAAO,QAAQ,EACvBC,EAAWD,EAAO,WAAW,EAC7BE,EAAKF,EAAO,YAAY,EACxBG,EAAeC,EAAIL,EAAO,EAAC,KAAK,CAAC,EAAE,QAAQ,GAAG,CAAC,EAE/CM,EAAW,CAChB,QAAS,eACT,iBAAkB,eAClB,WAAY,gBACZ,OAAQ,aACR,WAAY,cACZ,QAAS,aACV,EAGMC,EAAkB,CAAC,UAAW,WAAY,SAAU,UAAU,EAE9DC,EAAUC,EAAS,IAAM,CAC9B,MAAMD,EAAU,CAAA,EAEhB,UAAWE,KAAU,OAAO,OAAOC,EAAe,IAAI,EAAG,CACxD,IAAIC,EAAgBF,IAAW,iBAAmB,UAAYA,EAC1DE,KAAiBJ,EACpBA,EAAQI,CAAa,GAAK,EAE1BJ,EAAQI,CAAa,EAAI,CAE5B,CAEC,OAAOJ,CACR,CAAC,EAEDK,EACC,IAAMT,EAAa,MACnB,IAAM,CACLO,EAAe,MAAK,CACtB,CACA,EAEA,MAAMG,EAAkBC,GAChBJ,EAAe,KAAKP,EAAa,MAAM,KAAKW,CAAI,EAAE,OAAO,YAAY,CAAC,EAGxEC,EAAkBC,GAAM,MAAM,KAAKA,EAAE,KAAI,CAAE,EAAE,CAAC,EAE9CC,EAAO,CACZF,EAAeb,EAAG,QAAQ,CAAC,EAC3Ba,EAAeb,EAAG,QAAQ,CAAC,EAC3Ba,EAAeb,EAAG,SAAS,CAAC,EAC5Ba,EAAeb,EAAG,WAAW,CAAC,EAC9Ba,EAAeb,EAAG,UAAU,CAAC,EAC7Ba,EAAeb,EAAG,QAAQ,CAAC,EAC3Ba,EAAeb,EAAG,UAAU,CAAC,CAC9B,EAGMQ,EAAiBQ,EAAe,CACrC,IAAK,0CACL,KAAM,GACN,MAAO,kCACP,YAAa,CACZ,MAAO,CACN,SAAUjB,EAAS,KAAK,KACxB,UAAWE,EAAa,MAAM,OAAO,YAAY,EACjD,QAASA,EAAa,MAAM,MAAM,GAAG,EAAE,OAAO,YAAY,CAC7D,CACE,CACF,CAAC"}